<div class="container">
      <div class="header">
        <div>
          <div class="logo-section">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"  width="25" height="25" >
          <defs>
            <linearGradient id="purpleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
            </linearGradient>
          </defs>
          <!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.-->
          <path fill="url(#purpleGradient)" d="M128 128C128 110.3 113.7 96 96 96C78.3 96 64 110.3 64 128L64 464C64 508.2 99.8 544 144 544L544 544C561.7 544 576 529.7 576 512C576 494.3 561.7 480 544 480L144 480C135.2 480 128 472.8 128 464L128 128zM534.6 214.6C547.1 202.1 547.1 181.8 534.6 169.3C522.1 156.8 501.8 156.8 489.3 169.3L384 274.7L326.6 217.4C314.1 204.9 293.8 204.9 281.3 217.4L185.3 313.4C172.8 325.9 172.8 346.2 185.3 358.7C197.8 371.2 218.1 371.2 230.6 358.7L304 285.3L361.4 342.7C373.9 355.2 394.2 355.2 406.7 342.7L534.7 214.7z"/>
        </svg>
          <h1>Asset Reports</h1>
           </div>
          <p class="subtitle">View and manage all asset activities</p>
       
        </div>
        <div class="header-icon">üìä</div>
      </div>

      <div class="stats-grid">
        <div class="stat-card purple">
          <div>
            <div class="stat-label">Total Assets</div>
            <div class="stat-value">{{ totalLength }}</div>
          </div>
          <div class="stat-icon">üìä</div>
        </div>

        <div class="stat-card green">
          <div>
            <div class="stat-label">Checked In</div>
            <div class="stat-value">{{ checkInCount }}</div>
          </div>
          <div class="stat-icon">üì•</div>
        </div>

        <div class="stat-card orange">
          <div>
            <div class="stat-label">Checked Out</div>
            <div class="stat-value">{{ checkOutCount }}</div>
          </div>
          <div class="stat-icon">üì§</div>
        </div>

        <!-- <div class="stat-card">
          <div>
            <div class="stat-label">Maintenance</div>
            <div class="stat-value">{{ maintenanceCount }}</div>
          </div>
          <div class="stat-icon">üîß</div>
        </div> -->
      </div>

      <div class="filter-section">
        <h2 class="filter-title">üîç Filter & Search</h2>
        
        <div class="filter-row">
          <div class="search-group">
            <label>Search Records</label>
            <input 
              type="text" 
              [(ngModel)]="searchTerm"
              (input)="filterRecords()"
              placeholder="üîç Search by asset, customer, username, location..."
              class="search-input"
            />
          </div>

          <div class="action-group">
            <label>Action Type</label>
            <select 
              [(ngModel)]="selectedAction"
              (change)="filterRecords()"
              class="action-select"
            >
              <option value="">All Actions</option>
              <option value="Checked In">Check In</option>
              <option value="Checked Out">Check Out</option>
              <!-- <option value="Maintenance">Maintenance</option> -->
            </select>
          </div>
        </div>

        <div class="results-bar">
          <div>Showing <strong>{{ filteredRecords.length }}</strong> of <strong>{{ totalLength }}</strong> records</div>
          <button class="export-btn" (click)="exportToExcel()">‚¨áÔ∏è Export to Excel</button>
        </div>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>ASSET ID</th>
              <th>ASSET NAME</th>
              <th>CUSTOMER ID</th>
              <th>CUSTOMER NAME</th>
              <th>ACTION</th>
              <th (click)="sortByDate()" style="cursor: pointer;">DATE ‚ñº</th>
              <th>TIME</th>
              <th>LOCATION</th>
              <th>USERNAME</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let record of filteredRecords">
              <td class="asset-id">{{ record.assetId }}</td>
              <td class="asset-name">{{ record.assetName }}</td>
              <td>{{ record.customerId }}</td>
              <td>{{ record.customerName }}</td>
              <td>
                <span [class]="'action-badge ' + (record.action === 'Checked In' ? 'checked-in' : (record.action === 'Checked Out' ? 'checked-out' : ''))">
                  {{ record.action }}
                </span>
              </td>
              <td>{{ record.date }}</td>
              <td>{{ record.time}}</td>
              <td>{{ record.location }}</td>
              <td class="username">{{ record.username }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="footer">
      
      
          <hr style="border: 0.5px solid gray; margin: 0; width: 100%;">
          <div >
          
            <div>
              <mat-paginator [length]="totalLength" (page)="handlePageEvent($event)" [pageSize]="pageSize" [pageIndex]="pageIndex"
                [pageSizeOptions]="[5, 100, 200]" aria-label="Select page" style="z-index: 0; height: auto; font-size: 14px;">
              </mat-paginator>
            </div>
              <div>
              Last updated: {{ lastUpdated }}</div>
          </div>
          
        <!-- </div> -->
      </div>
      
    </div>